[{"specVersion":"1.0","workflow":{"gid":3683,"category":"category001","creator":"trial_user19","name":"prelab-basic2","description":"description info","createTime":1619160635000,"updateTime":1619161278000,"jobCount":0,"unknownCount":0,"workflowDefinition":{"components":[{"componentType":"batch","type":"batch","setting":{"properties":{"notifyLevel":{"level":"ERROR","messengerId":""},"workflow":{"name":"prelab-basic2","appName":"G3683","alias":"","libPath":"/tmp/lib/batch","useSystemLibPath":true,"xml":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<Workflow xmlns=\"uri:oozie:workflow:0.5\" xmlns:ns6=\"uri:oozie:distcp-action:0.2\" xmlns:ns5=\"uri:oozie:ssh-action:0.2\" xmlns:ns7=\"uri:oozie:spark-action:0.2\" xmlns:ns2=\"uri:oozie:hive-action:0.6\" xmlns:ns4=\"uri:oozie:shell-action:0.3\" xmlns:ns3=\"uri:oozie:sqoop-action:0.4\">\n    <start to=\"L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5\"/>\n    <action name=\"L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5\">\n        <ns7:spark>\n            <ns7:job-tracker>${jobTracker}</ns7:job-tracker>\n            <ns7:name-node>${nameNode}</ns7:name-node>\n            <ns7:configuration>\n                <ns7:property>\n                    <ns7:name>oozie.action.sharelib.for.spark</ns7:name>\n                    <ns7:value>spark2</ns7:value>\n                </ns7:property>\n            </ns7:configuration>\n            <ns7:master>yarn</ns7:master>\n            <ns7:mode>cluster</ns7:mode>\n            <ns7:name>prelab-basic2</ns7:name>\n            <ns7:jar>L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5.py</ns7:jar>\n            <ns7:spark-opts>--py-files asset.py --conf spark.yarn.appMasterEnv.PYSPARK_PYTHON=/usr/bin/python3.6 --conf spark.executorEnv.PYSPARK_PYTHON=/usr/bin/python3.6 --conf spark.yarn.appMasterEnv.PYTHONPATH=/home/dpcore/.local/lib/python3.6/site-packages --conf spark.executorEnv.PYTHONPATH=/home/dpcore/.local/lib/python3.6/site-packages</ns7:spark-opts>\n        </ns7:spark>\n        <ok to=\"end\"/>\n        <error to=\"kill\"/>\n    </action>\n    <kill name=\"kill\">\n        <message>killed</message>\n    </kill>\n    <end name=\"end\"/>\n</Workflow>\n"},"cluster":{"stackId":"EMR_446"},"notification":{"event":[],"notificationReceiver":[]}}},"scheduler":{"properties":{"enable":false,"start":null,"end":null,"timezone":"GMT+09:00","frequency":{"inputType":"Basic","frequencyNumber":5,"frequencyUnit":"minutes","frequencyCron":""},"controls":{"timeout":"-1","concurrency":"1","execution":"FIFO","throttle":"12"},"datasets":{"inputEvents":[{"name":"","uriTemplate":"","frequency":"","initialInstance":"","timezone":"","doneFlag":""}],"outputEvents":[{"name":"","uriTemplate":"","frequency":"","initialInstance":"","timezone":"","doneFlag":""}]}}},"jobProperty":{"properties":{"parameters":[{"key":"jobPropertyKey","value":"jobPropertyValue"}]}},"nodes":[{"uuid":"L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5","type":"ETL","label":"전처리","group":"hadoopBatch","link":[],"parent":"","child":[],"props":{"appName":"prelab-basic2","source":"#-- coding: utf-8 --\nimport sys\nsys.path.insert(0, \"/home/dpcore/.local/lib/python3.6/site-packages\")\n\nfrom pyspark.sql import SparkSession\nfrom pyspark import SparkContext, SparkConf\nfrom pyspark.sql.types import *\nfrom pyspark.sql import functions as F\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.functions import udf, col, lit, concat, last, avg, when, trim, ltrim, rtrim\nfrom pyspark.ml.feature import *\nfrom pyspark.ml import *\nimport json, csv, io, re, urllib\n\nconf = SparkConf().setAppName(\"pysparkApp\").set(\"spark.driver.cores\", 1).set(\"spark.driver.memory\", \"1G\").set(\"spark.executor.cores\", 1).set(\"spark.executor.memory\", \"1G\").set(\"spark.executor.instances\", 3)\nsqlContext = SparkSession.builder.config(conf=conf).enableHiveSupport().getOrCreate()\nsc = sqlContext.sparkContext\nsqlContext.sparkContext.addPyFile('asset.py')\nfrom asset import *\n\n# S3 불러오기 Credential\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.impl\",\"org.apache.hadoop.fs.s3a.S3AFileSystem\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.access.key\", \"AKIA2HASEMBXUGLOYWZV\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.secret.key\", \"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\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.endpoint\", \"s3.ap-northeast-2.amazonaws.com\")\n\n# S3 불러오기\ndf_tZv8 = sqlContext.read.option(\"delimiter\", \"\u0001\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").csv(sc.textFile(\"s3a://accu-trial/example/train_val_set2.csv\").map(lambda line : \"\u0001\".join(line.split(\",\"))))\n\n# Activate Smart Parser\ndf_tZv8 = smartParser(df_tZv8, \"none\", 0)\n\n# addConditionCol\ndf_tZv8.createOrReplaceTempView(\"default\")\ndf_D5u8 = sqlContext.sql(\"select *, case when type = 1 then 1 else 0 end as isType1, case when type = 2 then 1 else 0 end as isType2, case when type = 3 then 1 else 0 end as isType3, case when type = 4 then 1 else 0 end as isType4, case when type = 5 then 1 else 0 end as isType5 from default\")\n\n# S3 내보내기\n# HDFS 내보내기\n# HDFS 내보내기\ndef castVectorCol(df):\n    for name, dtype in df.dtypes:\n        if dtype == \"vector\":\n            df = df.withColumn(name, col(name).cast(\"string\"))\n    return df\n\ndf_D5u8= castVectorCol(df_D5u8)\ndf_D5u8.repartition(1).write.format(\"csv\").mode('overwrite').option(\"header\", \"true\").option(\"escape\", \"\\\"\").option(\"quoteMode\", \"NONE\").save(\"hdfs://10.31.200.227:8020/user/hadoop/one-hot\")\n\n# change permission\nURI = sc._gateway.jvm.java.net.URI\nPath = sc._gateway.jvm.org.apache.hadoop.fs.Path\nFileSystem = sc._gateway.jvm.org.apache.hadoop.fs.FileSystem\nConfiguration = sc._gateway.jvm.org.apache.hadoop.conf.Configuration\nFsPermission = sc._gateway.jvm.org.apache.hadoop.fs.permission.FsPermission\n\nfs = FileSystem.get(URI(\"hdfs://10.31.200.227:8020\"), Configuration())\n\ndef chmod(path):\n    fs.setPermission(path, FsPermission(\"777\"))\n    status = fs.listStatus(path)\n    for fileStatus in status:\n        if fileStatus.isDirectory():\n            chmod(fileStatus.getPath())\n        else:\n            fs.setPermission(fileStatus.getPath(), FsPermission(\"777\"))\n\nchmod(Path(\"/user/hadoop/one-hot\"))\nfs.close()\n\n# S3 내보내기 Credential\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.impl\",\"org.apache.hadoop.fs.s3a.S3AFileSystem\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.access.key\", \"AKIA2HASEMBXUGLOYWZV\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.secret.key\", \"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\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.endpoint\", \"s3.ap-northeast-2.amazonaws.com\")\n\n# S3 내보내기\ndf_D5u8.repartition(1).write.format(\"csv\").mode('overwrite').option(\"header\", \"true\").option(\"escape\", \"\\\"\").option(\"quoteMode\", \"NONE\").save(\"s3a://accu-trial/accu-trial19/prelab/one-hot\")\n\nsc.stop()","sampling":"limit","limit":"10000000","argument":[{"arg":""}],"sparkOpts":[{"key":"","value":""}],"pysparkPython":"/usr/bin/python3.6","pythonPath":"/home/dpcore/.local/lib/python3.6/site-packages","mode":"cluster","forceOK":false}},{"uuid":"tZv8-BJ7S-4zZP-376b-f08R-8leH-BC6m-Z484","name":"S3 불러오기_tZv8","type":"importS3","label":"S3 불러오기","group":"hadoopBatch","link":["D5u8-crsH-I5RV-poVJ-H0Gc-bv0U-V4Az-54Y4"],"parent":"L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5","child":[],"props":{"file":"s3a://accu-trial/example/train_val_set2.csv","format":"csv","delimiter":",","option":[{"key":"header","value":"true"}],"schema":[{"column":"","dataType":""}],"credential":{"fs.s3a.access.key":"AKIA2HASEMBXUGLOYWZV","fs.s3a.secret.key":"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","fs.s3a.endpoint":"s3.ap-northeast-2.amazonaws.com"}}},{"uuid":"D5u8-crsH-I5RV-poVJ-H0Gc-bv0U-V4Az-54Y4","name":"create isType","type":"addConditionCol","label":"addConditionCol","group":"hadoopBatch","link":["d98s-Vz47-5Xv3-77j4-42fr-L3LO-65j0-Ho5c","wP10-2pMA-wFaP-6Z7H-RWcT-CXf0-2Z7S-54Ld"],"parent":"L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5","child":[],"props":{"expression":[{"customCondition":"type = 1","trueValue":1,"falseValue":0,"newColumn":"isType1"},{"customCondition":"type = 2","trueValue":1,"falseValue":0,"newColumn":"isType2"},{"customCondition":"type = 3","trueValue":1,"falseValue":0,"newColumn":"isType3"},{"customCondition":"type = 4","trueValue":1,"falseValue":0,"newColumn":"isType4"},{"customCondition":"type = 5","trueValue":1,"falseValue":0,"newColumn":"isType5"}]}},{"uuid":"d98s-Vz47-5Xv3-77j4-42fr-L3LO-65j0-Ho5c","name":"HDFS 내보내기_d98s","type":"exportHDFS","label":"HDFS 내보내기","group":"hadoopBatch","link":[],"parent":"L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5","child":[],"props":{"path":"hdfs://10.31.200.227:8020/user/hadoop","folder":"one-hot","fileName":"","format":"csv","mode":"overwrite","header":"true","option":[{"key":"","value":""}],"highAvailability":false,"nameservices":"","namenode1":"","namenode2":"","mlDataset":{"mlDatasetName":"","mlDatasetDescription":"","livyEndpointUrl":"10.31.200.227:8998","token":"Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzY29wZSI6WyJjb3JlOmFsbCJdLCJleHAiOjE2MTkyNDQ2MTQsImF1dGhvcml0aWVzIjpbIlJPTEVfTVlfQ0xJRU5UIl0sImp0aSI6ImNjOWZiNWZmLTA2NzYtNGNjNS05OTg4LTViYTUwZTIwNmNhOSIsImNsaWVudF9pZCI6InRyaWFsX3VzZXIxOSJ9.HQ6PaB4CkIvFND17EHTcj63YihLai54nIQJ1nq1wG5OmQTyQfXCCNLJ7KBsjDsEts11MQC0vx1BFG782wJ0mmpGWkAwlFlgnWaMu_RcMTqHZszIlIwg6Ev3ktIytpDtDxXm-AqW8vkjwiTKTRXRUHmW0HJV0MgtVYToZfsps_TnE97RvN43PsfEOvU1YsKhTJe605e6zayjCs4BX9n1Z5gekXgUJu1haaWKopCPfbF4RGxzL_nTk49xttutbZFa5k1FXLsFAzdaqJ5Ajoc-wk6LwUzofbHvPekTqairw2ZK7M4Jr_dSlHeDKp1fAOnJtwsH9hM7m-eOEhxIOUB-yMQ"},"cluster":"EMR_446","clusterName":"trial_user19s"}},{"uuid":"wP10-2pMA-wFaP-6Z7H-RWcT-CXf0-2Z7S-54Ld","name":"S3 내보내기_wP10","type":"exportS3","label":"S3 내보내기","group":"hadoopBatch","link":[],"parent":"L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5","child":[],"props":{"path":"s3a://accu-trial/accu-trial19/prelab","folder":"one-hot","fileName":"","format":"csv","mode":"overwrite","header":"true","option":[{"key":"","value":""}],"credential":{"fs.s3a.access.key":"AKIA2HASEMBXUGLOYWZV","fs.s3a.secret.key":"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","fs.s3a.endpoint":"s3.ap-northeast-2.amazonaws.com"}}}],"extraProps":{"clusterInfo":{"hiveIP":"10.31.200.227","ozIP":"10.31.200.227","hosts":{"ip-10-31-200-227.ap-northeast-2.compute.internal":"10.31.200.227","hdp-master01":"10.31.200.227"},"nnPort":"8020","hivePort":"10000","mrJobHstIP":"10.31.200.227","mrJobHstPort":"19888","pythonPath":"/usr/bin/python3.6","ozPort":"11000","pythonPackagePath":"/home/dpcore/.local/lib/python3.6/site-packages","livyIP":"10.31.200.227","rmPort":"8032","jupyterIP":"10.31.200.227","nnIP":"10.31.200.227","jupyterPort":"8890","rmIP":"10.31.200.227","livyPort":"8998","hdfsIP":"10.31.200.227","rmwebPort":"8088","nmPort":"8040","nmWebPort":"8042","nnWebPort":"50070"}},"workflow":{"id":"3210","name":"prelab-basic2","appName":"G3683"}}]}},"workflowJson":"{\"L05T-84G6-0sZp-GuS3-jAb4-8wu4-ED00-G9z5\":\"-450 -280\",\"tZv8-BJ7S-4zZP-376b-f08R-8leH-BC6m-Z484\":\"-930 -480\",\"D5u8-crsH-I5RV-poVJ-H0Gc-bv0U-V4Az-54Y4\":\"-720 -480\",\"d98s-Vz47-5Xv3-77j4-42fr-L3LO-65j0-Ho5c\":\"-510 -480\",\"wP10-2pMA-wFaP-6Z7H-RWcT-CXf0-2Z7S-54Ld\":\"-510 -400\"}"},{"specVersion":"1.0","workflow":{"gid":3597,"category":"category001","creator":"trial_user19","name":"prelab_basic","description":"description info","createTime":1618382605000,"updateTime":1619235428000,"jobCount":0,"unknownCount":0,"workflowDefinition":{"components":[{"componentType":"batch","type":"batch","setting":{"properties":{"notifyLevel":{"level":"ERROR","messengerId":""},"workflow":{"name":"prelab_basic","appName":"G3597","alias":"","libPath":"/tmp/lib/batch","useSystemLibPath":true,"xml":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<Workflow xmlns=\"uri:oozie:workflow:0.5\" xmlns:ns6=\"uri:oozie:distcp-action:0.2\" xmlns:ns5=\"uri:oozie:ssh-action:0.2\" xmlns:ns7=\"uri:oozie:spark-action:0.2\" xmlns:ns2=\"uri:oozie:hive-action:0.6\" xmlns:ns4=\"uri:oozie:shell-action:0.3\" xmlns:ns3=\"uri:oozie:sqoop-action:0.4\">\n    <start to=\"N0dB-3me7-mGEI-Mc94-di7V-3T1M-t5bC-UH6o\"/>\n    <action name=\"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7\">\n        <ns7:spark>\n            <ns7:job-tracker>${jobTracker}</ns7:job-tracker>\n            <ns7:name-node>${nameNode}</ns7:name-node>\n            <ns7:configuration>\n                <ns7:property>\n                    <ns7:name>oozie.action.sharelib.for.spark</ns7:name>\n                    <ns7:value>spark2</ns7:value>\n                </ns7:property>\n            </ns7:configuration>\n            <ns7:master>yarn</ns7:master>\n            <ns7:mode>cluster</ns7:mode>\n            <ns7:name>prelab_basic</ns7:name>\n            <ns7:jar>p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7.py</ns7:jar>\n            <ns7:spark-opts>--py-files asset.py --conf spark.yarn.appMasterEnv.PYSPARK_PYTHON=/usr/bin/python3.6 --conf spark.executorEnv.PYSPARK_PYTHON=/usr/bin/python3.6 --conf spark.yarn.appMasterEnv.PYTHONPATH=/home/dpcore/.local/lib/python3.6/site-packages --conf spark.executorEnv.PYTHONPATH=/home/dpcore/.local/lib/python3.6/site-packages</ns7:spark-opts>\n        </ns7:spark>\n        <ok to=\"end\"/>\n        <error to=\"kill\"/>\n    </action>\n    <action name=\"N0dB-3me7-mGEI-Mc94-di7V-3T1M-t5bC-UH6o\">\n        <sub-workflow>\n            <app-path>3210</app-path>\n        </sub-workflow>\n        <ok to=\"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7\"/>\n        <error to=\"kill\"/>\n    </action>\n    <kill name=\"kill\">\n        <message>killed</message>\n    </kill>\n    <end name=\"end\"/>\n</Workflow>\n"},"cluster":{"stackId":"EMR_446"},"notification":{"event":[],"notificationReceiver":[]}}},"scheduler":{"properties":{"enable":false,"start":null,"end":null,"timezone":"GMT+09:00","frequency":{"inputType":"Basic","frequencyNumber":5,"frequencyUnit":"minutes","frequencyCron":""},"controls":{"timeout":"-1","concurrency":"1","execution":"FIFO","throttle":"12"},"datasets":{"inputEvents":[{"name":"","uriTemplate":"","frequency":"","initialInstance":"","timezone":"","doneFlag":""}],"outputEvents":[{"name":"","uriTemplate":"","frequency":"","initialInstance":"","timezone":"","doneFlag":""}]}}},"jobProperty":{"properties":{"parameters":[{"key":"jobPropertyKey","value":"jobPropertyValue"}]}},"nodes":[{"uuid":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","type":"ETL","label":"전처리","group":"hadoopBatch","link":[],"parent":"","child":[],"props":{"appName":"prelab_basic","source":"#-- coding: utf-8 --\nimport sys\nsys.path.insert(0, \"/home/dpcore/.local/lib/python3.6/site-packages\")\n\nfrom pyspark.sql import SparkSession\nfrom pyspark import SparkContext, SparkConf\nfrom pyspark.sql.types import *\nfrom pyspark.sql import functions as F\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.functions import udf, col, lit, concat, last, avg, when, trim, ltrim, rtrim\nfrom pyspark.ml.feature import *\nfrom pyspark.ml import *\nimport json, csv, io, re, urllib\n\nconf = SparkConf().setAppName(\"pysparkApp\").set(\"spark.driver.cores\", 1).set(\"spark.driver.memory\", \"1G\").set(\"spark.executor.cores\", 1).set(\"spark.executor.memory\", \"1G\").set(\"spark.executor.instances\", 3)\nsqlContext = SparkSession.builder.config(conf=conf).enableHiveSupport().getOrCreate()\nsc = sqlContext.sparkContext\nsqlContext.sparkContext.addPyFile('asset.py')\nfrom asset import *\n\n# S3 불러오기 Credential\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.impl\",\"org.apache.hadoop.fs.s3a.S3AFileSystem\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.access.key\", \"AKIA2HASEMBXUGLOYWZV\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.secret.key\", \"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\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.endpoint\", \"s3.ap-northeast-2.amazonaws.com\")\n\n# S3 불러오기 Custom Schema\ncustomSchema_l57t = StructType([StructField(\"type\", IntegerType(), True), StructField(\"amount\", DoubleType(), True), StructField(\"nameOrig\", StringType(), True), StructField(\"oldbalanceOrig\", DoubleType(), True), StructField(\"newbalanceOrig\", DoubleType(), True), StructField(\"nameDest\", StringType(), True), StructField(\"oldbalanceDest\", DoubleType(), True), StructField(\"newbalanceDest\", DoubleType(), True), StructField(\"isFraud\", IntegerType(), True)])\n\n# S3 불러오기\ndf_l57t = sqlContext.read.option(\"delimiter\", \"\u0001\").option(\"header\", \"true\").csv(sc.textFile(\"s3a://accu-trial/example/train_val_set2.csv\").map(lambda line : \"\u0001\".join(line.split(\",\"))), schema = customSchema_l57t)\n\n# Activate Smart Parser\ndf_l57t = smartParser(df_l57t, \"none\", 0)\n\n# dropna\ndf_a0WZ = df_l57t.dropna(\"any\")\n\n# drop\ndf_liBh = df_a0WZ.drop(\"nameOrig\", \"nameDest\")\n\n# filter\ndf_AQcM = df_liBh.filter((df_liBh['type'] == \"2\") | (df_liBh['type'] == \"5\"))\n\n# filter\ndf_Tc47 = df_AQcM.filter((df_AQcM['amount'] > 2005127))\n\n# filter\ndf_WWL3 = df_Tc47.filter((df_Tc47['isFraud'] == \"0\"))\n\n# stratified\ndf_ALtc = df_WWL3\n\n# filter\ndf_Pk4h = df_Tc47.filter((df_Tc47['isFraud'] == \"1\"))\n\n# SQL\ndf_liBh.createOrReplaceTempView(\"default\")\ndf_V6TC = sqlContext.sql(\"SELECT * FROM default WHERE type = 2 OR type = 5\")\n\n# unionAll\ndf_u0zy = df_ALtc.union(df_Pk4h)\n\n# upDown\ndf_h8Qd = upDownSampling(df_u0zy, \"isFraud\", \"0\", \"1\", \"up\")\n\n# S3 내보내기 Credential\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.impl\",\"org.apache.hadoop.fs.s3a.S3AFileSystem\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.access.key\", \"AKIA2HASEMBXUGLOYWZV\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.secret.key\", \"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\")\nsc._jsc.hadoopConfiguration().set(\"fs.s3a.endpoint\", \"s3.ap-northeast-2.amazonaws.com\")\n\n# S3 내보내기\ndf_h8Qd.repartition(1).write.format(\"csv\").mode('overwrite').option(\"header\", \"true\").option(\"escape\", \"\\\"\").option(\"quoteMode\", \"NONE\").save(\"s3a://accu-trial/accu-trial19/prelab/0423 lab\")\n\nsc.stop()","sampling":"limit","limit":"10000000","argument":[{"arg":""}],"sparkOpts":[{"key":"","value":""}],"pysparkPython":"/usr/bin/python3.6","pythonPath":"/home/dpcore/.local/lib/python3.6/site-packages","mode":"cluster","forceOK":false}},{"uuid":"l57t-jhAs-rJHW-Vl4I-0C49-dcSk-A12y-790c","name":"S3 불러오기_l57t","type":"importS3","label":"S3 불러오기","group":"hadoopBatch","link":["a0WZ-nm11-kIQK-jQZg-1LJE-4888-QzXG-0lO0"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"file":"s3a://accu-trial/example/train_val_set2.csv","format":"csv","delimiter":",","option":[{"key":"header","value":"true"}],"schema":[{"column":"type","dataType":"IntegerType()"},{"column":"amount","dataType":"DoubleType()"},{"column":"nameOrig","dataType":"StringType()"},{"column":"oldbalanceOrig","dataType":"DoubleType()"},{"column":"newbalanceOrig","dataType":"DoubleType()"},{"column":"nameDest","dataType":"StringType()"},{"column":"oldbalanceDest","dataType":"DoubleType()"},{"column":"newbalanceDest","dataType":"DoubleType()"},{"column":"isFraud","dataType":"IntegerType()"}],"credential":{"fs.s3a.access.key":"AKIA2HASEMBXUGLOYWZV","fs.s3a.secret.key":"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","fs.s3a.endpoint":"s3.ap-northeast-2.amazonaws.com"}}},{"uuid":"a0WZ-nm11-kIQK-jQZg-1LJE-4888-QzXG-0lO0","name":"dropna","type":"dropna","label":"dropna","group":"hadoopBatch","link":["liBh-R67K-98i8-Bx2V-lHh6-2N4y-vUiZ-RG5H"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"expression":{"selectType":"any","value":0},"subset":[{"col":""}]}},{"uuid":"liBh-R67K-98i8-Bx2V-lHh6-2N4y-vUiZ-RG5H","name":"drop  high unique ratio","type":"drop","label":"drop","group":"hadoopBatch","link":["V6TC-NbXG-H984-bp31-Da5J-i6bP-kkRr-M7h8","AQcM-0bL9-di37-jmJo-Np21-bMhQ-0fea-2kgn"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"col":["df_a0WZ.nameOrig","df_a0WZ.nameDest"]}},{"uuid":"V6TC-NbXG-H984-bp31-Da5J-i6bP-kkRr-M7h8","name":"filter type = 2, 5","type":"SQL","label":"SQL","group":"hadoopBatch","link":[],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"query":"SELECT * FROM default WHERE type = 2 OR type = 5","overwriteSchema":false,"newSchema":[{"column":"","dataType":""}]}},{"uuid":"AQcM-0bL9-di37-jmJo-Np21-bMhQ-0fea-2kgn","name":"filter type = 2, 5","type":"filter","label":"filter","group":"hadoopBatch","link":["Tc47-4cHf-7r3l-pR0E-clC6-um69-1cIJ-s27T"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"filters":[{"col":"df_liBh.type","filterOption":"= : equal","filterValue":"2"},{"col":"df_liBh.type","filterOption":"= : equal","filterValue":"5"}],"filterOperator":"OR","useCustom":false,"customCondition":""}},{"uuid":"Tc47-4cHf-7r3l-pR0E-clC6-um69-1cIJ-s27T","name":"outlier","type":"filter","label":"filter","group":"hadoopBatch","link":["Pk4h-PPJo-WJp8-e4AR-94Va-c70g-4d6n-8Nb2","WWL3-dd1V-3R2Y-fB5j-3sR1-WEU7-199Q-MOic"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"filters":[{"col":"df_AQcM.amount","filterOption":"> : greater than","filterValue":"2005127"}],"filterOperator":"AND","useCustom":false,"customCondition":""}},{"uuid":"WWL3-dd1V-3R2Y-fB5j-3sR1-WEU7-199Q-MOic","name":"isFraud = 0","type":"filter","label":"filter","group":"hadoopBatch","link":["ALtc-a5Tw-N97p-5atp-9hi5-EyCl-mS8y-qz80"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"filters":[{"col":"df_Tc47.isFraud","filterOption":"= : equal","filterValue":"0"}],"filterOperator":"AND","useCustom":false,"customCondition":""}},{"uuid":"Pk4h-PPJo-WJp8-e4AR-94Va-c70g-4d6n-8Nb2","name":"isFraud = 1","type":"filter","label":"filter","group":"hadoopBatch","link":["u0zy-8mLD-9E1Y-Q88x-AcZY-1C4F-5675-i2Jh"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"filters":[{"col":"df_Tc47.isFraud","filterOption":"= : equal","filterValue":"1"}],"filterOperator":"AND","useCustom":false,"customCondition":""}},{"uuid":"u0zy-8mLD-9E1Y-Q88x-AcZY-1C4F-5675-i2Jh","name":"unionAll_u0zy","type":"unionAll","label":"unionAll","group":"hadoopBatch","link":["h8Qd-a91m-Sb7r-695Q-7s6k-2N8e-alP0-v3wY"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{}},{"uuid":"ALtc-a5Tw-N97p-5atp-9hi5-EyCl-mS8y-qz80","name":"stratified_ALtc","type":"stratified","label":"stratified","group":"hadoopBatch","link":["u0zy-8mLD-9E1Y-Q88x-AcZY-1C4F-5675-i2Jh"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"method":{"selectType":"records","num":"0.1","fraction":"0.1"},"col":"df_WWL3.type","replacement":"False","includeJob":false,"purpose":"job"}},{"uuid":"h8Qd-a91m-Sb7r-695Q-7s6k-2N8e-alP0-v3wY","name":"upDown_h8Qd","type":"upDown","label":"upDown","group":"hadoopBatch","link":["Yu4K-2f4M-LVaN-3f2j-6U7x-834W-a9Sx-prkh"],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"method":"up","col":"df_u0zy.isFraud","labelFalse":"0","labelTrue":"1","purpose":"job"}},{"uuid":"Yu4K-2f4M-LVaN-3f2j-6U7x-834W-a9Sx-prkh","name":"S3 내보내기_Yu4K","type":"exportS3","label":"S3 내보내기","group":"hadoopBatch","link":[],"parent":"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7","child":[],"props":{"path":"s3a://accu-trial/accu-trial19/prelab","folder":"0423 lab","fileName":"","format":"csv","mode":"overwrite","header":"true","option":[{"key":"","value":""}],"credential":{"fs.s3a.access.key":"AKIA2HASEMBXUGLOYWZV","fs.s3a.secret.key":"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","fs.s3a.endpoint":"s3.ap-northeast-2.amazonaws.com"}}},{"uuid":"N0dB-3me7-mGEI-Mc94-di7V-3T1M-t5bC-UH6o","name":"subWorkflow_N0dB","type":"subWorkflow","label":"subWorkflow","group":"hadoopBatch","link":["p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7"],"parent":"","child":[],"props":{"propagateConfiguration":true,"appPath":3210,"workflowId":"G3683","workflowName":"prelab-basic2","configuration":[{"key":"","value":""}],"forceOK":false}}],"extraProps":{"clusterInfo":{"hiveIP":"10.31.200.227","ozIP":"10.31.200.227","hosts":{"ip-10-31-200-227.ap-northeast-2.compute.internal":"10.31.200.227","hdp-master01":"10.31.200.227"},"nnPort":"8020","hivePort":"10000","mrJobHstIP":"10.31.200.227","mrJobHstPort":"19888","pythonPath":"/usr/bin/python3.6","ozPort":"11000","pythonPackagePath":"/home/dpcore/.local/lib/python3.6/site-packages","livyIP":"10.31.200.227","rmPort":"8032","jupyterIP":"10.31.200.227","nnIP":"10.31.200.227","jupyterPort":"8890","rmIP":"10.31.200.227","livyPort":"8998","hdfsIP":"10.31.200.227","rmwebPort":"8088","nmPort":"8040","nmWebPort":"8042","nnWebPort":"50070"}},"workflow":{"id":"3124","name":"prelab_basic","appName":"G3597"}}]}},"workflowJson":"{\"p2yi-zyP4-X78O-B9Bv-O3Be-S2Id-xIY4-1eo7\":\"-360 -40\",\"l57t-jhAs-rJHW-Vl4I-0C49-dcSk-A12y-790c\":\"-1290 -440\",\"a0WZ-nm11-kIQK-jQZg-1LJE-4888-QzXG-0lO0\":\"-1080 -440\",\"liBh-R67K-98i8-Bx2V-lHh6-2N4y-vUiZ-RG5H\":\"-1080 -360\",\"V6TC-NbXG-H984-bp31-Da5J-i6bP-kkRr-M7h8\":\"-870 -280\",\"AQcM-0bL9-di37-jmJo-Np21-bMhQ-0fea-2kgn\":\"-1080 -280\",\"Tc47-4cHf-7r3l-pR0E-clC6-um69-1cIJ-s27T\":\"-1080 -200\",\"WWL3-dd1V-3R2Y-fB5j-3sR1-WEU7-199Q-MOic\":\"-1080 -120\",\"Pk4h-PPJo-WJp8-e4AR-94Va-c70g-4d6n-8Nb2\":\"-870 -120\",\"u0zy-8mLD-9E1Y-Q88x-AcZY-1C4F-5675-i2Jh\":\"-870 40\",\"ALtc-a5Tw-N97p-5atp-9hi5-EyCl-mS8y-qz80\":\"-1080 -40\",\"h8Qd-a91m-Sb7r-695Q-7s6k-2N8e-alP0-v3wY\":\"-870 120\",\"Yu4K-2f4M-LVaN-3f2j-6U7x-834W-a9Sx-prkh\":\"-660 120\",\"N0dB-3me7-mGEI-Mc94-di7V-3T1M-t5bC-UH6o\":\"-1560 -160\"}"}]